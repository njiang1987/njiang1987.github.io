<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="天空の城">
<meta property="og:url" content="http://www.njiang.cn/page/6/index.html">
<meta property="og:site_name" content="天空の城">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="天空の城">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.njiang.cn/page/6/"/>





  <title> 天空の城 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-43682645-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">天空の城</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">愤怒的程序员，梦想着有一天也能飞！</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.njiang.cn/2014/09/01/she-ji-mo-shi-shi-ba-ce-lue-mo-shi-strategy(dui-xiang-xing-wei-xing/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="姜楠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天空の城">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="天空の城" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/09/01/she-ji-mo-shi-shi-ba-ce-lue-mo-shi-strategy(dui-xiang-xing-wei-xing/" itemprop="url">
                  设计模式 ( 十八 ) 策略模式Strategy（对象行为型)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-09-01T10:17:27+08:00">
              2014-09-01
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2016-12-26T16:40:34+08:00">
              2016-12-26
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/09/01/she-ji-mo-shi-shi-ba-ce-lue-mo-shi-strategy(dui-xiang-xing-wei-xing/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/09/01/she-ji-mo-shi-shi-ba-ce-lue-mo-shi-strategy(dui-xiang-xing-wei-xing/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>设计模式 ( 十八 ) 策略模式Strategy（对象行为型）</p>
<p>1.概述</p>
<p>在软件开发中也常常遇到类似的情况，实现某一个功能有多种算法或者策略，我们可以根据环境或者条件的不同选择不同的算法或者策略来完成该功能。如查找、排序等，一种常用的方法是硬编码(Hard Coding)在一个类中，如需要提供多种查找算法，可以将这些算法写到一个类中，在该类中提供多个方法，每一个方法对应一个具体的查找算法；当然也可以将这些查找算法封装在一个统一的方法中，通过if…else…或者case等条件判断语句来进行选择。这两种实现方法我们都可以称之为硬编码，如果需要增加一种新的查找算法，需要修改封装算法类的源代码；更换查找算法，也需要修改客户端调用代码。在这个算法类中封装了大量查找算法，该类代码将较复杂，维护较为困难。如果我们将这些策略包含在客户端，这种做法更不可取，将导致客户端程序庞大而且难以维护，如果存在大量可供选择的算法时问题将变得更加严重。</p>
<p>例子1：一个菜单功能能够根据用户的“皮肤”首选项来决定是否采用水平的还是垂直的排列形式。同事可以灵活增加菜单那的显示样式。</p>
<p>例子2：出行旅游：我们可以有几个策略可以考虑：可以骑自行车，汽车，做火车，飞机。每个策略都可以得到相同的结果，但是它们使用了不同的资源。选择策略的依据是费用，时间，使用工具还有每种方式的方便程度 。</p>
<img src="/uploads/2014/09/01/1.png" class="center">
<p>2.问题</p>
<p>如何让算法和对象分开来，使得算法可以独立于使用它的客户而变化？</p>
<p>3.解决方案</p>
<p>策略模式：定义一系列的算法,把每一个算法封装起来, 并且使它们可相互替换。本模式使得算法可独立于使用它的客户而变化。也称为政策模式(Policy)。（Definea family of algorithms,encapsulate each one, andmake them interchangeable. Strategy lets the algorithmvary independently from clients that use it. ）</p>
<p>策略模式把对象本身和运算规则区分开来，其功能非常强大，因为这个设计模式本身的核心思想就是面向对象编程的多形性的思想。</p>
<p>4.适用性</p>
<p>当存在以下情况时使用Strategy模式<br>1）许多相关的类仅仅是行为有异。 “策略”提供了一种用多个行为中的一个行为来配置一个类的方法。即一个系统需要动态地在几种算法中选择一种。</p>
<p>2）需要使用一个算法的不同变体。例如，你可能会定义一些反映不同的空间 /时间权衡的算法。当这些变体实现为一个算法的类层次时 ,可以使用策略模式。</p>
<p>3）算法使用客户不应该知道的数据。可使用策略模式以避免暴露复杂的、与算法相关的数据结构。</p>
<p>4）一个类定义了多种行为 , 并且这些行为在这个类的操作中以多个条件语句的形式出现。将相关的条件分支移入它们各自的Strategy类中以代替这些条件语句。</p>
<p>5.结构<br><img src="/uploads/2014/09/01/2.jpg" class="center"></p>
<p>6.模式的组成</p>
<p>环境类(Context):用一个ConcreteStrategy对象来配置。维护一个对Strategy对象的引用。可定义一个接口来让Strategy访问它的数据。<br>抽象策略类(Strategy):定义所有支持的算法的公共接口。 Context使用这个接口来调用某ConcreteStrategy定义的算法。<br>具体策略类(ConcreteStrategy):以Strategy接口实现某具体算法。</p>
<p>7.效果</p>
<p>Strategy模式有下面的一些优点：</p>
<p>1) 相关算法系列 Strategy类层次为Context定义了一系列的可供重用的算法或行为。 继承有助于析取出这些算法中的公共功能。</p>
<p>2) 提供了可以替换继承关系的办法： 继承提供了另一种支持多种算法或行为的方法。你可以直接生成一个Context类的子类，从而给它以不同的行为。但这会将行为硬行编制到 Context中，而将算法的实现与Context的实现混合起来,从而使Context难以理解、难以维护和难以扩展，而且还不能动态地改变算法。最后你得到一堆相关的类 , 它们之间的唯一差别是它们所使用的算法或行为。 将算法封装在独立的Strategy类中使得你可以独立于其Context改变它，使它易于切换、易于理解、易于扩展。</p>
<p>3) 消除了一些if else条件语句 ：Strategy模式提供了用条件语句选择所需的行为以外的另一种选择。当不同的行为堆砌在一个类中时 ,很难避免使用条件语句来选择合适的行为。将行为封装在一个个独立的Strategy类中消除了这些条件语句。含有许多条件语句的代码通常意味着需要使用Strategy模式。</p>
<p>4) 实现的选择 Strategy模式可以提供相同行为的不同实现。客户可以根据不同时间 /空间权衡取舍要求从不同策略中进行选择。</p>
<p>Strategy模式缺点:</p>
<p>1)客户端必须知道所有的策略类，并自行决定使用哪一个策略类:  本模式有一个潜在的缺点，就是一个客户要选择一个合适的Strategy就必须知道这些Strategy到底有何不同。此时可能不得不向客户暴露具体的实现问题。因此仅当这些不同行为变体与客户相关的行为时 , 才需要使用Strategy模式。</p>
<p>2 ) Strategy和Context之间的通信开销 ：无论各个ConcreteStrategy实现的算法是简单还是复杂, 它们都共享Strategy定义的接口。因此很可能某些 ConcreteStrategy不会都用到所有通过这个接口传递给它们的信息；简单的 ConcreteStrategy可能不使用其中的任何信息！这就意味着有时Context会创建和初始化一些永远不会用到的参数。如果存在这样问题 , 那么将需要在Strategy和Context之间更进行紧密的耦合。</p>
<p>3 )策略模式将造成产生很多策略类：可以通过使用享元模式在一定程度上减少对象的数量。 增加了对象的数目 Strategy增加了一个应用中的对象的数目。有时你可以将 Strategy实现为可供各Context共享的无状态的对象来减少这一开销。任何其余的状态都由 Context维护。Context在每一次对Strategy对象的请求中都将这个状态传递过去。共享的 Strategy不应在各次调用之间维护状态。</p>
<p>8.实现</p>
<p>1)出行旅游：</p>
<p>uml：<br><img src="/uploads/2014/09/01/3.jpg" class="center"></p>
<p>代码实现：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** </span></div><div class="line">* 策略模式 </div><div class="line">* 定义一系列的算法,把每一个算法封装起来, 并且使它们可相互替换。本模式使得算法可独立于使用它的客户而变化 </div><div class="line">* </div><div class="line">*/   </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="comment">/** </span></div><div class="line">* 出行旅游 </div><div class="line">* </div><div class="line">*  </div><div class="line">*/  </div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">TravelStrategy</span></span>&#123;  </div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">travelAlgorithm</span><span class="params">()</span></span>;  </div><div class="line">&#125;   </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="comment">/** </span></div><div class="line"> * 具体策略类(ConcreteStrategy)1：乘坐飞机 </div><div class="line"> */  </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AirPlanelStrategy</span> <span class="keyword">implements</span> <span class="title">TravelStrategy</span> </span>&#123;  </div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">travelAlgorithm</span><span class="params">()</span></span>&#123;  </div><div class="line">        <span class="keyword">echo</span> <span class="string">"travel by AirPlain"</span>, <span class="string">"&lt;BR&gt;\r\n"</span>;   </div><div class="line">    &#125;  </div><div class="line">&#125;   </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="comment">/** </span></div><div class="line"> * 具体策略类(ConcreteStrategy)2：乘坐火车 </div><div class="line"> */  </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrainStrategy</span> <span class="keyword">implements</span> <span class="title">TravelStrategy</span> </span>&#123;  </div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">travelAlgorithm</span><span class="params">()</span></span>&#123;  </div><div class="line">        <span class="keyword">echo</span> <span class="string">"travel by Train"</span>, <span class="string">"&lt;BR&gt;\r\n"</span>;   </div><div class="line">    &#125;  </div><div class="line">&#125;   </div><div class="line">  </div><div class="line"><span class="comment">/** </span></div><div class="line"> * 具体策略类(ConcreteStrategy)3：骑自行车 </div><div class="line"> */  </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BicycleStrategy</span> <span class="keyword">implements</span> <span class="title">TravelStrategy</span> </span>&#123;  </div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">travelAlgorithm</span><span class="params">()</span></span>&#123;  </div><div class="line">        <span class="keyword">echo</span> <span class="string">"travel by Bicycle"</span>, <span class="string">"&lt;BR&gt;\r\n"</span>;   </div><div class="line">    &#125;  </div><div class="line">&#125;   </div><div class="line">  </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="comment">/** </span></div><div class="line"> *  </div><div class="line"> * 环境类(Context):用一个ConcreteStrategy对象来配置。维护一个对Strategy对象的引用。可定义一个接口来让Strategy访问它的数据。 </div><div class="line"> * 算法解决类，以提供客户选择使用何种解决方案： </div><div class="line"> */  </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonContext</span></span>&#123;  </div><div class="line">    <span class="keyword">private</span> $_strategy = <span class="keyword">null</span>;  </div><div class="line">  </div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(TravelStrategy $travel)</span></span>&#123;  </div><div class="line">        <span class="keyword">$this</span>-&gt;_strategy = $travel;  </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">/** </span></div><div class="line">    * 旅行 </div><div class="line">    */  </div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setTravelStrategy</span><span class="params">(TravelStrategy $travel)</span></span>&#123;  </div><div class="line">        <span class="keyword">$this</span>-&gt;_strategy = $travel;  </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">/** </span></div><div class="line">    * 旅行 </div><div class="line">    */  </div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">travel</span><span class="params">()</span></span>&#123;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_strategy -&gt;travelAlgorithm();  </div><div class="line">    &#125;  </div><div class="line">&#125;   </div><div class="line">  </div><div class="line"><span class="comment">// 乘坐火车旅行  </span></div><div class="line">$person = <span class="keyword">new</span> PersonContext(<span class="keyword">new</span> TrainStrategy());  </div><div class="line">$person-&gt;travel();  </div><div class="line">  </div><div class="line"><span class="comment">// 改骑自行车  </span></div><div class="line">$person-&gt;setTravelStrategy(<span class="keyword">new</span> BicycleStrategy());  </div><div class="line">$person-&gt;travel();</div></pre></td></tr></table></figure>
<p>2)排序策略:某系统提供了一个用于对数组数据进行操作的类，该类封装了对数组的常见操作，</p>
<p>如查找数组元素、对数组元素进行排序等。现以排序操作为例，使用策略模式设计该数组操作类，</p>
<p>使得客户端可以动态地更换排序算法，可以根据需要选择冒泡排序或选择排序或插入排序，</p>
<p>也能够灵活地增加新的排序算法。</p>
<p>9.与其他相关模式</p>
<p>1）状态模式</p>
<p>策略模式和其它许多设计模式比较起来是非常类似的。策略模式和状态模式最大的区别就是策略模式只是的条件选择只执行一次，而状态模式是随着实例参数（对象实例的状态）的改变不停地更改执行模式。换句话说，策略模式只是在</p>
<p>对象初始化的时候更改执行模式，而状态模式是根据对象实例的周期时间而动态地改变对象实例的执行模式。</p>
<p>•可以通过环境类状态的个数来决定是使用策略模式还是状态模式。<br>•策略模式的环境类自己选择一个具体策略类，具体策略类无须关心环境类；而状态模式的环境类由于外在因素需要放进一个具体状态中，<br>以便通过其方法实现状态的切换，因此环境类和状态类之间存在一种双向的关联关系。<br>•使用策略模式时，客户端需要知道所选的具体策略是哪一个，而使用状态模式时，客户端无须关心具体状态，环境类的状态会根据用户的操作自动转换。<br>•如果系统中某个类的对象存在多种状态，不同状态下行为有差异，而且这些状态之间可以发生转换时使用状态模式；<br>如果系统中某个类的某一行为存在多种实现方式，而且这些实现方式可以互换时使用策略模式。<br>2）简单工厂的区别：点击打开链接</p>
<p>工厂模式是创建型模式 ，它关注对象创建，提供创建对象的接口. 让对象的创建与具体的使用客户无关。<br>策略模式是对象行为型模式 ，它关注行为和算法的封装 。它定义一系列的算法,把每一个算法封装起来, 并且使它们可相互替换。使得算法可独立于使用它的客户而变化</p>
<p>用我们上面提到旅行的例子：<br>我们去旅行。策略模式的做法：有几种方案供你选择旅行，选择火车好呢还是骑自行车，完全有客户自行决定去构建旅行方案（比如你自己需要去买火车票，或者机票）。而工厂模式是你决定哪种旅行方案后，不用关注这旅行方案怎么给你创建，也就是说你告诉我方案的名称就可以了，然后由工厂代替你去构建具体方案（工厂代替你去买火车票）。</p>
<p>上面的例子里面client代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$person = new PersonContext(new TrainStrategy());</div><div class="line">$person-&gt;travel();</div></pre></td></tr></table></figure></p>
<p>我们看到客户需要自己去创建具体旅行（new TrainStrategy()）实例。传递的是具体实例。<br>而工厂模式你只要告诉哪种旅行就可以了，不是传递一个具体实例，而是一个标识（旅行方案标识）。</p>
<p>10.总结与分析</p>
<p>1）策略模式是一个比较容易理解和使用的设计模式，策略模式是对算法的封装，它把算法的责任和算法本身分割开，委派给不同的对象管理。策略模式通常把一个系列的算法封装到一系列的策略类里面，作为一个抽象策略类的子类。用一句话来说，就是“准备一组算法，并将每一个算法封装起来，使得它们可以互换”。<br>2）在策略模式中，应当由客户端自己决定在什么情况下使用什么具体策略角色。2）<br>3）策略模式仅仅封装算法，提供新算法插入到已有系统中，以及老算法从系统中“退休”的方便，策略模式并不决定在何时使用何种算法，算法的选择由客户端来决定。这在一定程度上提高了系统的灵活性，但是客户端需要理解所有具体策略类之间的区别，以便选择合适的算法，这也是策略模式的缺点之一，在一定程度上增加了客户端的使用难度。</p>
<p>转自：<a href="http://blog.csdn.net/hguisu/article/details/7558249" target="_blank" rel="external">http://blog.csdn.net/hguisu/article/details/7558249</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.njiang.cn/2014/08/21/investigate-on-cgcontext-and-implement-wifi-view/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="姜楠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天空の城">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="天空の城" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/21/investigate-on-cgcontext-and-implement-wifi-view/" itemprop="url">
                  Investigate on CGContext and implement Wifi view
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-21T23:46:04+08:00">
              2014-08-21
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2016-12-26T16:40:34+08:00">
              2016-12-26
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/08/21/investigate-on-cgcontext-and-implement-wifi-view/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/08/21/investigate-on-cgcontext-and-implement-wifi-view/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Today, I did some research on CGContext. And implement an animation graph and Wifi view. Please the code below.</p>
<p>Here is the screen shot. </p>
<img src="/uploads/2014/08/22/1.png" class="center" width="320" height="568">
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  TestView.m</span></div><div class="line"><span class="comment">//  Depression</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  Created by jn11585852 on 8/21/14.</span></div><div class="line"><span class="comment">//  Copyright (c) 2014 JiangNan. All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"TestView.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">TestView</span> ()</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> percent;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">retain</span>) <span class="built_in">NSTimer</span>* timer;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> timeInterval;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">TestView</span></span></div><div class="line"><span class="keyword">@synthesize</span> timer = _timer;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)didMoveToWindow</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">super</span> didMoveToWindow];</div><div class="line">    <span class="keyword">self</span>.percent = <span class="number">0.0</span>f;</div><div class="line">    <span class="keyword">self</span>.timeInterval = <span class="number">0.01</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)startAnimation</div><div class="line">&#123;</div><div class="line">    <span class="comment">// start a timer to re-render the view</span></div><div class="line">    <span class="keyword">self</span>.timer = [<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="keyword">self</span>.timeInterval target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(increaseAndRender) userInfo:<span class="literal">nil</span> repeats:<span class="literal">YES</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)stopAnimation</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">self</span>.timer invalidate];</div><div class="line">    <span class="keyword">self</span>.timer = <span class="literal">nil</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)increaseAndRender</div><div class="line">&#123;</div><div class="line">    <span class="comment">// called once time when time invoke it. so we need to increase the percent by  on step</span></div><div class="line">    <span class="built_in">CGFloat</span> step = <span class="keyword">self</span>.finalPercent / (<span class="number">1.0</span> / <span class="keyword">self</span>.timeInterval);</div><div class="line">    <span class="keyword">self</span>.percent += step;</div><div class="line">    <span class="comment">// if the percent is bigger than the final percent, we should stop the timer</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.percent &gt; <span class="keyword">self</span>.finalPercent) &#123;</div><div class="line">        [<span class="keyword">self</span>.timer invalidate];</div><div class="line">        <span class="keyword">self</span>.timer = <span class="literal">nil</span>;</div><div class="line">    &#125;</div><div class="line">    [<span class="keyword">self</span> setNeedsDisplay];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// Only override drawRect: if you perform custom drawing.</span></div><div class="line"><span class="comment">// An empty implementation adversely affects performance during animation.</span></div><div class="line">- (<span class="keyword">void</span>)drawRect:(<span class="built_in">CGRect</span>)rect</div><div class="line">&#123;</div><div class="line">    <span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line">    <span class="built_in">CGContextSaveGState</span>(ctx);</div><div class="line">    </div><div class="line">    [<span class="keyword">self</span> drawRectangle:ctx];</div><div class="line">    [<span class="keyword">self</span> drawCircle:ctx];</div><div class="line">    [<span class="keyword">self</span> drawWifi:ctx];</div><div class="line">    </div><div class="line">    <span class="built_in">CGContextRestoreGState</span>(ctx);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)drawRectangle:(<span class="built_in">CGContextRef</span>)ctx</div><div class="line">&#123;</div><div class="line">    <span class="built_in">CGContextSetStrokeColorWithColor</span>(ctx, [[<span class="built_in">UIColor</span> greenColor] <span class="built_in">CGColor</span>]);</div><div class="line">    <span class="built_in">CGContextSetFillColorWithColor</span>(ctx, [[<span class="built_in">UIColor</span> lightGrayColor] <span class="built_in">CGColor</span>]);</div><div class="line">    <span class="built_in">CGContextMoveToPoint</span>(ctx, <span class="number">20</span>, <span class="number">50</span>);</div><div class="line">    <span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">300</span>, <span class="number">50</span>);</div><div class="line">    <span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">300</span>, <span class="number">60</span>);</div><div class="line">    <span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">20</span>, <span class="number">60</span>);</div><div class="line">    <span class="built_in">CGContextClosePath</span>(ctx);</div><div class="line">    </div><div class="line">    <span class="built_in">CGPathRef</span> path = <span class="built_in">CGContextCopyPath</span>(ctx);</div><div class="line">    <span class="built_in">CGContextStrokePath</span>(ctx);</div><div class="line">    <span class="built_in">CGContextAddPath</span>(ctx, path);</div><div class="line">    <span class="built_in">CGContextFillPath</span>(ctx);</div><div class="line">    </div><div class="line">    <span class="built_in">CGContextSetFillColorWithColor</span>(ctx, [[<span class="built_in">UIColor</span> redColor] <span class="built_in">CGColor</span>]);</div><div class="line">    <span class="built_in">CGContextMoveToPoint</span>(ctx, <span class="number">20</span>, <span class="number">50</span>);</div><div class="line">    <span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">20</span> + <span class="number">280</span> * <span class="keyword">self</span>.percent, <span class="number">50</span>);</div><div class="line">    <span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">20</span> + <span class="number">280</span> * <span class="keyword">self</span>.percent, <span class="number">60</span>);</div><div class="line">    <span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">20</span>, <span class="number">60</span>);</div><div class="line">    <span class="built_in">CGContextClosePath</span>(ctx);</div><div class="line">    <span class="built_in">CGContextFillPath</span>(ctx);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)drawCircle:(<span class="built_in">CGContextRef</span>)ctx</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">self</span> drawCurve:ctx start:<span class="number">0</span> end:<span class="keyword">self</span>.percent color:[[<span class="built_in">UIColor</span> redColor] <span class="built_in">CGColor</span>]];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.percent &gt; <span class="number">0.3</span>) &#123;</div><div class="line">        [<span class="keyword">self</span> drawCurve:ctx start:<span class="number">0.3</span> end:<span class="keyword">self</span>.percent color:[[<span class="built_in">UIColor</span> greenColor] <span class="built_in">CGColor</span>]];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.percent &gt; <span class="number">0.6</span>) &#123;</div><div class="line">        [<span class="keyword">self</span> drawCurve:ctx start:<span class="number">0.6</span> end:<span class="keyword">self</span>.percent color:[[<span class="built_in">UIColor</span> blackColor] <span class="built_in">CGColor</span>]];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)drawCurve:(<span class="built_in">CGContextRef</span>)ctx start:(<span class="built_in">CGFloat</span>)start end:(<span class="built_in">CGFloat</span>)end color:(<span class="built_in">CGColorRef</span>)color</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">self</span> drawCurve:ctx start:start end:end color:color radius:<span class="number">100</span> center:<span class="built_in">CGPointMake</span>(<span class="number">200</span>, <span class="number">200</span>)];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)drawWifi:(<span class="built_in">CGContextRef</span>)ctx</div><div class="line">&#123;</div><div class="line">    <span class="comment">// it is very interesting here, we will draw it from outside to inside. final there is only a circle.</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> radius = <span class="number">50</span>; radius &gt; <span class="number">0</span>; ) &#123;</div><div class="line">        [<span class="keyword">self</span> drawCurve:ctx start:<span class="number">0.625</span> end:<span class="number">0.875</span> color:[[<span class="built_in">UIColor</span> greenColor] <span class="built_in">CGColor</span>] radius:radius center:<span class="built_in">CGPointMake</span>(<span class="number">100</span>, <span class="number">400</span>)];</div><div class="line">        </div><div class="line">        radius -= <span class="number">20</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)drawCurve:(<span class="built_in">CGContextRef</span>)ctx start:(<span class="built_in">CGFloat</span>)start end:(<span class="built_in">CGFloat</span>)end color:(<span class="built_in">CGColorRef</span>)color radius:(<span class="built_in">CGFloat</span>)radius center:(<span class="built_in">CGPoint</span>)center</div><div class="line">&#123;</div><div class="line">    <span class="comment">// draw a big arc</span></div><div class="line">    <span class="built_in">CGContextSetFillColorWithColor</span>(ctx, color);</div><div class="line">    <span class="built_in">CGContextMoveToPoint</span>(ctx, center.x, center.y);</div><div class="line">    <span class="built_in">CGContextAddArc</span>(ctx, center.x, center.y, radius, <span class="number">2</span> * M_PI * start, <span class="number">2</span> * M_PI * end, <span class="number">0</span>);</div><div class="line">    <span class="built_in">CGContextClosePath</span>(ctx);</div><div class="line">    <span class="built_in">CGContextFillPath</span>(ctx);</div><div class="line">    </div><div class="line">    <span class="comment">// then draw the inside small one</span></div><div class="line">    <span class="built_in">CGContextSetFillColorWithColor</span>(ctx, [[<span class="built_in">UIColor</span> whiteColor] <span class="built_in">CGColor</span>]);</div><div class="line">    <span class="built_in">CGContextMoveToPoint</span>(ctx, center.x, center.y);</div><div class="line">    <span class="built_in">CGContextAddLineToPoint</span>(ctx, center.x + radius - <span class="number">10</span>, center.y);</div><div class="line">    <span class="built_in">CGContextAddArc</span>(ctx, center.x, center.y, radius - <span class="number">10</span>, <span class="number">0</span>, <span class="number">2</span> * M_PI, <span class="number">0</span>);</div><div class="line">    <span class="built_in">CGContextClosePath</span>(ctx);</div><div class="line">    <span class="built_in">CGContextFillPath</span>(ctx);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.njiang.cn/2014/08/20/ctci-reverse-char-array-using-c/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="姜楠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天空の城">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="天空の城" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/20/ctci-reverse-char-array-using-c/" itemprop="url">
                  [CTCI]-Homework Part 1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-20T20:21:26+08:00">
              2014-08-20
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2016-12-26T16:40:34+08:00">
              2016-12-26
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/08/20/ctci-reverse-char-array-using-c/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/08/20/ctci-reverse-char-array-using-c/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##1.1 Implement an algorithm to determine if a string has all unique characters. What if you cannot use additional data structures?</p>
<p>####Solution 1. Use hash table<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">String testStr = <span class="string">"abca"</span>;</div><div class="line"><span class="keyword">boolean</span> lRepeatChar = <span class="keyword">false</span>;<span class="comment">// = repeatString(testStr);</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; testStr.length(); i++)</div><div class="line">&#123;</div><div class="line">	String c = testStr.substring(i, i+<span class="number">1</span>);</div><div class="line">	<span class="keyword">if</span>(lTest.containsKey(c))</div><div class="line">	&#123;</div><div class="line">		lRepeatChar = <span class="keyword">true</span>;</div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span></div><div class="line">	&#123;</div><div class="line">		lTest.put(c, <span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>####Solution 2. Recursive<br>Not Recommend this one.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">repeatChar</span><span class="params">(<span class="keyword">char</span> c, String substr)</span></span></div><div class="line">&#123;	</div><div class="line">	<span class="keyword">if</span>(substr == <span class="keyword">null</span> || substr.length() == <span class="number">0</span>)</div><div class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	</div><div class="line">	<span class="keyword">char</span> next = substr.charAt(<span class="number">0</span>);</div><div class="line">	<span class="keyword">if</span>(next == c)</div><div class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	</div><div class="line">	<span class="keyword">boolean</span> lRepeatChar = repeatChar(c, substr.substring(<span class="number">1</span>));</div><div class="line">	<span class="keyword">if</span>(lRepeatChar == <span class="keyword">true</span>)</div><div class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	<span class="keyword">else</span></div><div class="line">	&#123;</div><div class="line">		lRepeatChar = repeatChar(next, substr.substring(<span class="number">1</span>));</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">return</span> lRepeatChar;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">repeatString</span><span class="params">(String str)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(str == <span class="keyword">null</span> || str.length() == <span class="number">0</span>)</div><div class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	</div><div class="line">	<span class="keyword">char</span> c = str.charAt(<span class="number">0</span>);</div><div class="line">	String substr = str.substring(<span class="number">1</span>);</div><div class="line">	<span class="keyword">return</span> repeatChar(c, substr);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>##1.2 Implement a function void reverse(char* str) in C or C++ which reverses a null- terminated string.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverseString</span><span class="params">(<span class="keyword">char</span>* str)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> n = <span class="number">0</span>;</div><div class="line">    <span class="comment">// find the end of the char[].</span></div><div class="line">    <span class="keyword">while</span> (str[n] != <span class="string">'\0'</span>) &#123;</div><div class="line">        n++;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// using 2 integer to index the char and reverse</span></div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = n - <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (i &lt; j) &#123;</div><div class="line">        <span class="keyword">char</span> t = str[i];</div><div class="line">        str[i] = str[j];</div><div class="line">        str[j] = t;</div><div class="line">        i++;</div><div class="line">        j--;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>##1.3 Given two strings, write a method to decide if one is a permutation of the other.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringComparer</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> String mString1;</div><div class="line">	<span class="keyword">private</span> String mString2;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">StringComparer</span><span class="params">(String iStr1, String iStr2)</span></span></div><div class="line">	&#123;</div><div class="line">		mString1 = iStr1;</div><div class="line">		mString2 = iStr2;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">// Solution 1, using hash table</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">couldRearrange</span><span class="params">()</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span>(mString1 == <span class="keyword">null</span> || mString2 == <span class="keyword">null</span>)</div><div class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">		</div><div class="line">		<span class="keyword">if</span>(mString1.length() != mString2.length())</div><div class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">		</div><div class="line">		Hashtable&lt;String, Integer&gt; lCacheTable = <span class="keyword">new</span> Hashtable&lt;String, Integer&gt;();</div><div class="line">		</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mString1.length(); i++)</div><div class="line">		&#123;</div><div class="line">			String c = mString1.substring(i, i+<span class="number">1</span>);</div><div class="line">			Integer lCount = lCacheTable.get(c);</div><div class="line">			<span class="keyword">if</span>(lCount == <span class="keyword">null</span>)</div><div class="line">			&#123;</div><div class="line">				lCacheTable.put(c, <span class="number">1</span>);</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span></div><div class="line">			&#123;</div><div class="line">				lCacheTable.put(c, lCount+<span class="number">1</span>);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mString2.length(); i++)</div><div class="line">		&#123;</div><div class="line">			String c = mString2.substring(i, i+<span class="number">1</span>);</div><div class="line">			Integer lCount = lCacheTable.get(c);</div><div class="line">			<span class="keyword">if</span>(lCount == <span class="keyword">null</span> || lCount == <span class="number">0</span>)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span></div><div class="line">			&#123;</div><div class="line">				lCount -= <span class="number">1</span>;</div><div class="line">				<span class="keyword">if</span>(lCount == <span class="number">0</span>)</div><div class="line">				&#123;</div><div class="line">					lCacheTable.remove(c);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">else</span></div><div class="line">				&#123;</div><div class="line">					lCacheTable.put(c, lCount);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">// solution 2, sort string</span></div><div class="line">	<span class="function"><span class="keyword">private</span> String <span class="title">sort</span><span class="params">(String t)</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">char</span>[] s = t.toCharArray();</div><div class="line">		java.util.Arrays.sort(s);</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> String(s);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">couldRearrange2</span><span class="params">()</span></span></div><div class="line">	&#123;</div><div class="line">		String str1 = <span class="keyword">this</span>.sort(mString1);</div><div class="line">		String str2 = <span class="keyword">this</span>.sort(mString2);</div><div class="line">		<span class="keyword">if</span>(str1.compareTo(str2) == <span class="number">0</span>)</div><div class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">// soltion 3. using array to store the char count</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">couldRearrange3</span><span class="params">()</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span>(mString1 == <span class="keyword">null</span> || mString2 == <span class="keyword">null</span> ||  mString1.length() != mString2.length())</div><div class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">		</div><div class="line">		<span class="keyword">int</span> marks[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</div><div class="line">		</div><div class="line">		<span class="keyword">char</span>[] s = mString1.toCharArray();</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">char</span> c: s)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">int</span> index = (<span class="keyword">int</span>)c;</div><div class="line">			marks[index]++;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mString2.length(); i++)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">int</span> index = (<span class="keyword">int</span>)mString2.charAt(i);</div><div class="line">			<span class="keyword">if</span>(marks[index] == <span class="number">0</span>)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span></div><div class="line">			&#123;</div><div class="line">				marks[index]--;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="1-4-Write-a-method-to-replace-all-spaces-in-a-string-with’-20’-You-may-assume-that-the-string-has-sufficient-space-at-the-end-of-the-string-to-hold-the-additional-characters-and-that-you-are-given-the-“true”-length-of-the-string-Note-if-imple-menting-in-Java-please-use-a-character-array-so-that-you-can-perform-this-opera-tion-in-place"><a href="#1-4-Write-a-method-to-replace-all-spaces-in-a-string-with’-20’-You-may-assume-that-the-string-has-sufficient-space-at-the-end-of-the-string-to-hold-the-additional-characters-and-that-you-are-given-the-“true”-length-of-the-string-Note-if-imple-menting-in-Java-please-use-a-character-array-so-that-you-can-perform-this-opera-tion-in-place" class="headerlink" title="1.4 Write a method to replace all spaces in a string with’%20’. You may assume that the string has sufficient space at the end of the string to hold the additional characters, and that you are given the “true” length of the string. (Note: if imple- menting in Java, please use a character array so that you can perform this opera- tion in place.)"></a>1.4 Write a method to replace all spaces in a string with’%20’. You may assume that the string has sufficient space at the end of the string to hold the additional characters, and that you are given the “true” length of the string. (Note: if imple- menting in Java, please use a character array so that you can perform this opera- tion in place.)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">replaceBlankTest</span><span class="params">(<span class="keyword">char</span>[] str, <span class="keyword">int</span> length)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(length == <span class="number">0</span>)</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	</div><div class="line">	<span class="keyword">int</span> index = <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> blankCount = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(str[index] != <span class="string">'\0'</span> &amp;&amp; index &lt; length)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span>(str[index] == <span class="string">' '</span>) blankCount++;</div><div class="line">		index++;</div><div class="line">	&#125;</div><div class="line">	index--;</div><div class="line">	</div><div class="line">	<span class="keyword">int</span> externCount = blankCount * <span class="number">2</span>;</div><div class="line">	<span class="keyword">int</span> endIndex = index + externCount;</div><div class="line">	<span class="keyword">while</span>(index &gt;= <span class="number">0</span>)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span>(str[index] == <span class="string">' '</span>)</div><div class="line">		&#123;</div><div class="line">			blankCount--;</div><div class="line">			str[endIndex] = <span class="string">'0'</span>;</div><div class="line">			str[endIndex-<span class="number">1</span>] = <span class="string">'2'</span>;</div><div class="line">			str[endIndex-<span class="number">2</span>] = <span class="string">'%'</span>;</div><div class="line">			endIndex -= <span class="number">3</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">		&#123;</div><div class="line">			str[endIndex] = str[index];</div><div class="line">			endIndex--;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		index--;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.njiang.cn/2014/08/17/stringbuffer-simple-implementation-in-java/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="姜楠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天空の城">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="天空の城" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/17/stringbuffer-simple-implementation-in-java/" itemprop="url">
                  [CTCI]-StringBuffer simple implementation in Java
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-17T08:45:50+08:00">
              2014-08-17
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2016-12-26T16:40:34+08:00">
              2016-12-26
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/08/17/stringbuffer-simple-implementation-in-java/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/08/17/stringbuffer-simple-implementation-in-java/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Here is an implementation of String Buffer. It use an link list to store the appended string. If there is no enough space for the append string, it will create an new node for the new string.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringBufferTest</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">    * Each node represent part of strings.</div><div class="line">    */</div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span></div><div class="line">    &#123;</div><div class="line">          <span class="keyword">public</span> <span class="keyword">char</span>[] data;</div><div class="line">          <span class="keyword">public</span> Node next;</div><div class="line">         </div><div class="line">          <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">()</span></span></div><div class="line">          &#123;</div><div class="line">               data = <span class="keyword">new</span> <span class="keyword">char</span>[size];</div><div class="line">               next = <span class="keyword">null</span>;</div><div class="line">          &#125;</div><div class="line">    &#125;</div><div class="line">   </div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> size = <span class="number">5</span>;</div><div class="line">    <span class="keyword">private</span> Node first;</div><div class="line">    <span class="keyword">private</span> Node currentNode;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> index;</div><div class="line">   </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StringBufferTest</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">          first = <span class="keyword">new</span> Node();</div><div class="line">          currentNode = first;</div><div class="line">          index = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">   </div><div class="line">   	<span class="comment">// Thanks for Robert C, Wang's improve the code.</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">append</span><span class="params">(String inputStr)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (inputStr == <span class="keyword">null</span>)</div><div class="line">               <span class="keyword">return</span>;</div><div class="line"></div><div class="line">        <span class="comment">// Copy the string to the node data</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; inputStr.length(); i++) &#123;</div><div class="line">            <span class="keyword">if</span>(index == size) &#123;	<span class="comment">// Create a new node at end</span></div><div class="line">                Node newNode = <span class="keyword">new</span> Node();</div><div class="line">                currentNode.next = newNode;</div><div class="line">                currentNode = currentNode.next;</div><div class="line">                index = <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">            currentNode.data[index++] = inputStr.charAt(i);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">    	String result = <span class="string">""</span>;</div><div class="line">    	Node p = first;</div><div class="line">    	<span class="keyword">while</span>(p != <span class="keyword">null</span>)</div><div class="line">    	&#123;</div><div class="line">    		result += String.valueOf(p.data);</div><div class="line">    		p = p.next;</div><div class="line">    	&#125;</div><div class="line">    	<span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">    * <span class="doctag">@param</span> args</div><div class="line">    */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">          StringBufferTest test = <span class="keyword">new</span> StringBufferTest();</div><div class="line">          test.append(<span class="string">"123456"</span>);</div><div class="line">          test.append(<span class="string">"789"</span>);</div><div class="line">          </div><div class="line">          String result = test.toString();</div><div class="line">          System.out.print(result);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.njiang.cn/2014/08/15/hashtablearray-using-java/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="姜楠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天空の城">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="天空の城" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/15/hashtablearray-using-java/" itemprop="url">
                  [CTCI]-HashTableArray using Java
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-15T13:58:07+08:00">
              2014-08-15
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2016-12-26T16:40:34+08:00">
              2016-12-26
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/08/15/hashtablearray-using-java/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/08/15/hashtablearray-using-java/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Using an array to store hash key/value.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.njiang.base;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashTableArray</span>&lt;<span class="title">Key</span>, <span class="title">Value</span>&gt; </span></div><div class="line">&#123;	</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HTEntity</span>&lt;<span class="title">Key</span>, <span class="title">Value</span>&gt;</span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">public</span> Key mKey;</div><div class="line">		<span class="keyword">public</span> Value mValue;</div><div class="line">		</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="title">HTEntity</span><span class="params">()</span></span></div><div class="line">		&#123;</div><div class="line">			<span class="keyword">this</span>.mKey = <span class="keyword">null</span>;</div><div class="line">			<span class="keyword">this</span>.mValue = <span class="keyword">null</span>;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="title">HTEntity</span><span class="params">(Key iKey, Value iValue)</span></span></div><div class="line">		&#123;</div><div class="line">			<span class="keyword">this</span>.mKey = iKey;</div><div class="line">			<span class="keyword">this</span>.mValue = iValue;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	HTEntity&lt;Key, Value&gt;[] mTable;</div><div class="line">	<span class="keyword">public</span> <span class="keyword">int</span> mCapicity = <span class="number">5</span>;</div><div class="line">	<span class="keyword">public</span> <span class="keyword">int</span> mCount;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> mSeed;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">HashTableArray</span><span class="params">()</span></span></div><div class="line">	&#123;</div><div class="line">		mTable = <span class="keyword">new</span> HTEntity[mCapicity];</div><div class="line">		mCount = <span class="number">0</span>;</div><div class="line">		mSeed = <span class="number">13</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(<span class="keyword">final</span> Key iKey)</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> lIndex = (mSeed^iKey.hashCode()) % mCapicity;</div><div class="line">		<span class="keyword">return</span> lIndex;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(Key iKey, Value iValue)</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span>(iKey == <span class="keyword">null</span> || iValue == <span class="keyword">null</span>)</div><div class="line">			<span class="keyword">return</span>;</div><div class="line">		</div><div class="line">		<span class="keyword">if</span>(mCount == mCapicity)</div><div class="line">		&#123;</div><div class="line">			HTEntity&lt;Key, Value&gt;[] mTmpTable = <span class="keyword">new</span> HTEntity[<span class="number">2</span>*mCapicity];</div><div class="line">			mCapicity = <span class="number">2</span> * mCapicity;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mCount; i++)</div><div class="line">			&#123;</div><div class="line">				Key lKey = mTable[i].mKey;</div><div class="line">				<span class="keyword">int</span> index = <span class="keyword">this</span>.hash(lKey);</div><div class="line">				<span class="keyword">while</span>(mTmpTable[index] != <span class="keyword">null</span>)</div><div class="line">				&#123;</div><div class="line">					index = (index + <span class="number">1</span>) % mCapicity;</div><div class="line">				&#125;</div><div class="line">					</div><div class="line">				mTmpTable[index] = mTable[i];</div><div class="line">			&#125;</div><div class="line">			mTable = mTmpTable;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="keyword">int</span> index = <span class="keyword">this</span>.hash(iKey);</div><div class="line">		<span class="keyword">while</span>(mTable[index] != <span class="keyword">null</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (mTable[index].mKey.equals(iKey))</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">			index = (index + <span class="number">1</span>) % mCapicity;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		mTable[index] = <span class="keyword">new</span> HTEntity(iKey, iValue);</div><div class="line">		mCount++;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Key iKey)</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span>(iKey == <span class="keyword">null</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">return</span>;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="keyword">int</span> index = <span class="keyword">this</span>.hash(iKey);</div><div class="line">		<span class="keyword">while</span>(mTable[index] != <span class="keyword">null</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span>(mTable[index].mKey.equals(iKey))</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">			index = (index + <span class="number">1</span>) % mCapicity;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="keyword">if</span>(mTable[index] == <span class="keyword">null</span>)</div><div class="line">		&#123;</div><div class="line">			System.out.print(<span class="string">"There is no element with key "</span> + iKey);</div><div class="line">			<span class="keyword">return</span> ;</div><div class="line">		&#125;</div><div class="line">		mTable[index] = <span class="keyword">null</span>;</div><div class="line">		mCount--;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.njiang.cn/2014/08/13/cracking-the-coding-interview-technical-preparation-1/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="姜楠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天空の城">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="天空の城" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/13/cracking-the-coding-interview-technical-preparation-1/" itemprop="url">
                  [CTCI]-Technical Preparation(1)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-13T22:31:33+08:00">
              2014-08-13
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2016-12-26T16:40:34+08:00">
              2016-12-26
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/08/13/cracking-the-coding-interview-technical-preparation-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/08/13/cracking-the-coding-interview-technical-preparation-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>###1. How to Practice a Question</p>
<ol>
<li>Try to solve the problem on your own.</li>
<li>Write the code for the algorithm on paper.</li>
<li>Test your code - on paper.</li>
<li>Type your paper code as-is into a computer.</li>
</ol>
<p>###2. What You need to Know</p>
<table>
<thead>
<tr>
<th>Data Structures</th>
<th>Algorithms</th>
<th>Concepts</th>
</tr>
</thead>
<tbody>
<tr>
<td>Linked List</td>
<td>Breadth First Search</td>
<td>BitManipulation</td>
</tr>
<tr>
<td>Binary Trees</td>
<td>Depth First Search</td>
<td>Singleton Design Pattern</td>
</tr>
<tr>
<td>Tries</td>
<td>Binary Search</td>
<td>Factory Design Pattern</td>
</tr>
<tr>
<td>Stacks</td>
<td>Merge Sort</td>
<td>Memory (Stack vs. Heap)</td>
</tr>
<tr>
<td>Queues</td>
<td>Quick Sourt</td>
<td>Recursion</td>
</tr>
<tr>
<td>Vectors / ArrayList</td>
<td>Tree Insert / Find / e.t.c</td>
<td>Big-O Time</td>
</tr>
<tr>
<td>HashTables</td>
<td></td>
</tr>
</tbody>
</table>
<p>In Praticular, hash tables are an extremely important topic. You will find that you use them frequently in solving interview questions.</p>
<p>###3. Five Steps to a Technical Question</p>
<ol>
<li>Ask your interviewer questions to resolve ambiguity.</li>
<li>Design an Algorithm.</li>
<li>Write pseudocode first, but make sure to tell your interviewer that you’ll eventually write “real” code.</li>
<li>Write your code at a moderate pace.</li>
<li>Test your code and carefully fix any mistakes.</li>
</ol>
<p>The more problems you practice, the esier it will be to identify which approach to use!!!</p>
<p>####1. Ask Questions,<br>Good Questions might be ones like: what are the data types? How much data is there? What assumptions do you need to solve the problem? Who is the user?</p>
<p>####2. Design an Algorithm<br>Keep in mind:</p>
<ol>
<li>What are its space and time complexity?</li>
<li>What happens if there is a lot of data?</li>
<li>Does your design cause other issues? For example, if you’re creating a modified version of a binary search tree, did your design impact the time for insert, find, or delete?</li>
<li>If there are other issues or limitations, did you make the right trade-offs? For which scenarios might the trade-off be less optimal?</li>
<li>If they gave your specific data.</li>
</ol>
<p>####3. Pseudocode</p>
<p>####4. Code</p>
<ol>
<li>Use Data Structures Generously.</li>
<li>Don’t Crowd Your Coding.</li>
</ol>
<p>####5. Test</p>
<ol>
<li>Extreme cases:0, negative, null, maximums, minimums.</li>
<li>User error: what happens if the user passes in null or a negative value?</li>
<li>General cases: Test the normal case.</li>
</ol>
<p>###4.Five approaches</p>
<ol>
<li>Examplify</li>
<li>Pattern Matching</li>
<li>Simplify and Generalize</li>
<li>Base Case and Build</li>
<li>Data Structure Brainstorm</li>
</ol>
<p>###5. What Good Coding Looks Like</p>
<ol>
<li>Correct.</li>
<li>Efficient.</li>
<li>Simple.</li>
<li>Readable.</li>
<li>Maintainable.</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.njiang.cn/2014/08/08/ios-guan-yu-objective-cfang-fa-de-imp/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="姜楠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天空の城">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="天空の城" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/08/ios-guan-yu-objective-cfang-fa-de-imp/" itemprop="url">
                  iOS 关于Objective-C方法的IMP
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-08T12:39:42+08:00">
              2014-08-08
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2016-12-26T16:40:34+08:00">
              2016-12-26
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/08/08/ios-guan-yu-objective-cfang-fa-de-imp/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/08/08/ios-guan-yu-objective-cfang-fa-de-imp/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>###一.什么是IMP<br>IMP是”implementation”的缩写，它是objetive-C 方法(method)实现代码块的地址，可像C函数一样直接调用。通常情况下我们是通过[object method:parameter]或objc_msgSend()的方式向对象发送消息，然后Objective-C运行时(Objective-C runtime)寻找匹配此消息的IMP,然后调用它;但有些时候我们希望获取到IMP进行直接调用。</p>
<p>###二.Objetive-C中的Method结构<br>在Objecitve-C中，在类中对每一个方法有一个在运行时构建的数据结构，在Objective-C 2.0中，此结构对用户不可见，但仍在内部存在。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> objc_method</div><div class="line">&#123;</div><div class="line">  SEL method_name;</div><div class="line">  <span class="keyword">char</span> * method_types;</div><div class="line">  IMP method_imp;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">typedef</span> objc_method Method;</div></pre></td></tr></table></figure>
<p>每个方法有3个属性<br>方法名：方法名为此方法的签名，有着相同函数名和参数名的方法有着相同的方法名。<br>方法类型：方法类型描述了参数的类型。<br>IMP: IMP即函数指针，为方法具体实现代码块的地址，可像普通C函数调用一样使用IMP。<br>由于Method的内部结构不可见，所以不能通过method-&gt;method_name的方式访问其内部属性，只能Objective-C运行时提供的函数获取。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SEL method_getName(Method method);</div><div class="line">IMP method_getImplementation(Method method);</div><div class="line"><span class="keyword">const</span> <span class="keyword">char</span> * ivar_getTypeEncoding(Ivar ivar);</div></pre></td></tr></table></figure>
<p>还有一些其他函数来获取方法的各种属性，具体可见Objective-C Runtime Reference。</p>
<p>###三.获取当前方法的默认IMP(default IMP)<br>NSObject对象提供了两个方法来获取的IMP</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">- (IMP)methodForSelector:(SEL)aSelector;</div><div class="line">+ (IMP)instanceMethodForSelector:(SEL)aSelector;</div></pre></td></tr></table></figure>
<p>使用<code>methodForSelector</code>方法时，若向类(class)发送消息，则aSelector应该是类方法(class method);若向实例对象(instance)发送消息，则aSelector应该为实例对象方法(instance method)。使用<code>instanceMethodForSelector</code>可向类请求实例方法的IMP。<br>那么获取当前方法的IMP,可使用self对象和隐含的_cmd参数。<br><code>IMP current = [self class] instanceMethodForSelector:_cmd];</code><br>methodForSelector返回的IMP是default IMP,即发送消息时会调用的IMP。但可能有其他情况不是这样的,但到底什么情况下呢?不懂，如下:</p>
<blockquote>
<p>methodForSelector: only returns the default IMP that will be invoked by a send message but you could have arrived at the current method through a super invocation, or a direct invocation of the IMP itself. The approach shown in this post gets the correct IMP no matter how it was invoked.</p>
</blockquote>
<p>###四. 另一种hack的方式获取当前方法IMP</p>
<p>GCC有个内建(build-in)函数,可获取当前栈帧的返回地址（参数0表示当前栈帧）。<br><code>__builtin_return_address(0)</code><br>这里有两个假设<br>方法的实现是连续的。<br>在方法中调用子函数，在子函数中调用<strong>builtin_return_address(0)得到的返回地址在当前方法实现的内部。<br>那么可以得出结论，当前方法实现的起始地址(即IMP)肯定在的子函数返回地址的前面，而且会比任何其他方法离的更近。则可通过如下方法寻找IMP。<br>当当前方法中，调用一个寻找IMP的子函数，将当前类和_cmd参数传递给子函数；<br>在子函数中使用</strong>builtin_return_address(0)获得返回地址，遍历当前类和当前父类的所有方法，寻找method_name与_cmd相等，而method_imp在__builtin_return_address(0)之前，且离其最近，则此IMP即为当前的的IMP。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/objc-class.h&gt;</span></span></div><div class="line">IMP impOfCallingMethod(<span class="keyword">id</span> lookupObject, SEL selector)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSUInteger</span> returnAddress = (<span class="built_in">NSUInteger</span>)__builtin_return_address(<span class="number">0</span>);</div><div class="line">    <span class="built_in">NSUInteger</span> closest = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="comment">// Iterate over the class and all superclasses</span></div><div class="line">    Class currentClass = object_getClass(lookupObject);</div><div class="line">    <span class="keyword">while</span> (currentClass)</div><div class="line">    &#123;</div><div class="line">        <span class="comment">// Iterate over all instance methods for this class</span></div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> methodCount;</div><div class="line">        Method *methodList = class_copyMethodList(currentClass, &amp;methodCount);</div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> i;</div><div class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; methodCount; i++)</div><div class="line">        &#123;</div><div class="line">            <span class="comment">// Ignore methods with different selectors</span></div><div class="line">            <span class="keyword">if</span> (method_getName(methodList[i]) != selector)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">// If this address is closer, use it instead</span></div><div class="line">            <span class="built_in">NSUInteger</span> address = (<span class="built_in">NSUInteger</span>)method_getImplementation(methodList[i]);</div><div class="line">            <span class="keyword">if</span> (address &lt; returnAddress &amp;&amp; address &gt; closest)</div><div class="line">            &#123;</div><div class="line">                closest = address;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        free(methodList);</div><div class="line">        currentClass = class_getSuperclass(currentClass);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (IMP)closest;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其使用方法为:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)myMethodWithParam1:(<span class="keyword">int</span>)someParameter andParam2:(<span class="keyword">int</span>)otherParameter</div><div class="line">&#123;</div><div class="line">   IMP myImplementation = impOfCallingInstanceMethod([<span class="keyword">self</span> <span class="keyword">class</span>], _cmd);</div><div class="line"></div><div class="line">   ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>另外还有更快速的方法:获取当前方法的返回地址,然后通过此地址回溯到父函数的IMP内部，在父函数IMP中寻找调用当前函数的位置，即可知道当前函数的IMP，不过此方法是平台相关的。<br>注:此方法假设IMP地址与子函数返回地址之间是连续的，中间不会有其他方法IMP。如果将impOfCallingMethod放到block代码中，则此条件不再满足，不再适用。(待验证)<br>参考：<br>IMP of the current method<br>Objective-C Runtime Reference<br>NSObject Class Reference</p>
<p>本文出自 清风徐来，水波不兴 的博客，转载时请注明出处及相应链接。<br>本文永久链接: <a href="http://www.winddisk.com/2012/06/13/objective-c-method-imp/" target="_blank" rel="external">http://www.winddisk.com/2012/06/13/objective-c-method-imp/</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.njiang.cn/2014/08/02/iosbian-li-wei-zhi-dui-xiang/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="姜楠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天空の城">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="天空の城" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/02/iosbian-li-wei-zhi-dui-xiang/" itemprop="url">
                  iOS遍历未知对象
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-02T13:29:53+08:00">
              2014-08-02
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2016-12-26T16:40:34+08:00">
              2016-12-26
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/08/02/iosbian-li-wei-zhi-dui-xiang/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/08/02/iosbian-li-wei-zhi-dui-xiang/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSObject</span> (<span class="title">PropertyListing</span>)   </span></div><div class="line"></div><div class="line"><span class="comment">/* 获取对象的所有属性 */</span></div><div class="line">- (<span class="built_in">NSDictionary</span> *)properties_aps</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSMutableDictionary</span> *props = [<span class="built_in">NSMutableDictionary</span> dictionary];   </div><div class="line">   <span class="keyword">unsigned</span> <span class="keyword">int</span> outCount, i;   </div><div class="line">   objc_property_t *properties = class_copyPropertyList([<span class="keyword">self</span> <span class="keyword">class</span>], &amp;outCount);   </div><div class="line">   <span class="keyword">for</span> (i = <span class="number">0</span>; i&lt;outCount; i++)</div><div class="line">    &#123;</div><div class="line">       objc_property_t property = properties[i];</div><div class="line">       <span class="keyword">const</span> <span class="keyword">char</span>* char_f =property_getName(property);</div><div class="line">       <span class="built_in">NSString</span> *propertyName = [<span class="built_in">NSString</span> stringWithUTF8String:char_f];</div><div class="line">       <span class="keyword">id</span> propertyValue = [<span class="keyword">self</span> valueForKey:(<span class="built_in">NSString</span> *)propertyName];   </div><div class="line">       <span class="keyword">if</span> (propertyValue) [props setObject:propertyValue forKey:propertyName];   </div><div class="line">    &#125;   </div><div class="line">   free(properties);   </div><div class="line">   <span class="keyword">return</span> props;   </div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="comment">/* 获取对象的所有方法 */</span></div><div class="line">-(<span class="keyword">void</span>)printMothList</div><div class="line">&#123;</div><div class="line">   <span class="keyword">unsigned</span> <span class="keyword">int</span> mothCout_f =<span class="number">0</span>;</div><div class="line">   Method* mothList_f = class_copyMethodList([<span class="keyword">self</span> <span class="keyword">class</span>],&amp;mothCout_f);</div><div class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;mothCout_f;i++)</div><div class="line">    &#123;</div><div class="line">       Method temp_f = mothList_f[i];</div><div class="line">       IMP imp_f = method_getImplementation(temp_f);</div><div class="line">       SEL name_f = method_getName(temp_f);</div><div class="line">       <span class="keyword">const</span> <span class="keyword">char</span>* name_s =sel_getName(method_getName(temp_f));</div><div class="line">       <span class="keyword">int</span> arguments = method_getNumberOfArguments(temp_f);</div><div class="line">       <span class="keyword">const</span> <span class="keyword">char</span>* encoding =method_getTypeEncoding(temp_f);</div><div class="line">       <span class="built_in">NSLog</span>(<span class="string">@"方法名：%@,参数个数：%d,编码方式：%@"</span>,[<span class="built_in">NSString</span> stringWithUTF8String:name_s],</div><div class="line">                                            arguments,</div><div class="line">                            [<span class="built_in">NSString</span> stringWithUTF8String:encoding]);</div><div class="line">    &#125;</div><div class="line">   free(mothList_f);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.njiang.cn/2014/07/31/iosxue-xi-bi-ji-core-data/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="姜楠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天空の城">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="天空の城" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/07/31/iosxue-xi-bi-ji-core-data/" itemprop="url">
                  iOS学习笔记——Core Data
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-07-31T23:57:17+08:00">
              2014-07-31
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2016-12-26T16:40:34+08:00">
              2016-12-26
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/07/31/iosxue-xi-bi-ji-core-data/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/07/31/iosxue-xi-bi-ji-core-data/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##7.1. 什么是Core Data</p>
<p>Core Data是一个Cocoa框架，用于为管理对象图提供基础实现，以及为多种文件格式的持久化提供支持。管理对象图包含的工作如撤销（undo）和重做（redo）、有效性检查、以及保证对象关系的完整性等。对象的持久化意味着Core Data可以将模型对象保存到持久化存储中，并在需要的时候将它们取出。Core Data应用程序的持久化存储（也就是对象数据的最终归档形式）的范围可以从XML文件到SQL数据库。Core Data用在关系数据库的前端应用程序是很理想的，但是所有的Cocoa应用程序都可以利用它的能力。</p>
<p>Core Data的核心概念是托管对象。托管对象是由Core Data管理的简单模型对象，但必须是NSManagedObject类或其子类的实例。可以用一个称为托管对象模型的结构（schema）来描述Core Data应用程序的托管对象（Xcode中包含一个数据建模工具，可以帮助您创建这些结构）。托管对象模型包含一些应用程序托管对象（也称为实体）的描述。每个描述负责指定一个实体的属性、它与其它实体的关系、以及像实体名称和实体表示类这样的元数据。</p>
<p>在一个运行着的Core Data程序中，有一个称为托管对象上下文的对象负责管理托管对象图。图中所有的托管对象都需要通过托管对象上下文来注册。该上下文对象允许在图中加入或删除对象，以及跟踪图中对象的变化，并因此可以提供撤销（undo）和重做（redo）的支持。当准备好保存对托管对象所做的修改时，托管对象上下文负责确保那些对象处于正确的状态。当Core Data应用程序希望从外部的数据存储中取出数据时，就向托管对象上下文发出一个取出请求，也就是一个指定一组条件的对象。在自动注册之后，上下文对象会从存储中返回与请求相匹配的对象。</p>
<p>托管对象上下文还作为访问潜在Core Data对象集合的网关，这个集合称为持久化堆栈。持久化堆栈处于应用程序对象和外部数据存储之间，由两种不同类型的对象组成，即持久化存储和持久化存储协调器对象。持久化存储位于栈的底部，负责外部存储（比如XML文件）的数据和托管对象上下文的相应对象之间的映射，但是它们不直接和托管对象上下文进行交互。在栈的持久化存储上面是持久化存储协调器，这种对象为一或多个托管对象上下文提供一个访问接口，使其下层的多个持久化存储可以表现为单一一个聚合存储。图7-1显示了Core Data架构中各种对象之间的关系。</p>
<img src="/uploads/2014-07-31/1.png" class="center" width="370" height="396"> 
<p>图7-1</p>
<p>Core Data中包含一个NSPersistentDocument类，它是NSDocument的子类，用与协助Core Data和文档架构之间的集成。持久化文档对象创建自己的持久化堆栈和托管对象上下文，将文档映射到一个外部的数据存储；NSPersistentDocument对象则为NSDocument中读写文档数据的方法提供缺省的实现。</p>
<p>通过Core Data管理应用程序的数据模型，可以极大程度减少需编写的代码数量。Core Data还具有下述特征：</p>
<ol>
<li>将对象数据存储在SQLite数据库以获得性能优化。</li>
<li>提供NSFetchedResultsController 类用于管理表视图的数据。即将Core Data的持久化存储显示在表视图中，并对这些数据进行管理：增、删，改。</li>
<li>管理undo/redo操作。</li>
<li>检查托管对象的属性值是否正确。</li>
</ol>
<p>###7.1.1. Core Data基本架构</p>
<p>在大多数应用中，需要打开一个文件，此文件包含一个有多个对象的归档，或者包含一个对至少一个根对象的引用。还需要能够归档所有对象到一个文件，并跟踪对象的变化。例如，在一个员工管理应用中，需要一种方法来打开一个文件，其中包含员工和部门对象的归档，并包含一个对至少一个根对象的引用——例如，含有全体员工的数组——如图7-2。还需要能够归档所有员工和所有部门到一个文件。</p>
<img src="/uploads/2014-07-31/2.png" class="center" width="456" height="455"> 
<p>图 7-2</p>
<p>使用的Core Data框架，大多数功能可以自动提供，这主要通过名为托管对象上下文（managed object context，或只是“上下文”，类NSManagedObjectContext的实例）来实现。托管对象的上下文就像一个网关，通过它可以访问底层的框架对象集合——这些对象集合统称为持久化堆栈（persistence stack）——它在应用程序和外部数据存储的对象之间提供访问通道。在堆栈的底部是持久化对象存储（persistent object stores），如图7-3所示。</p>
<img src="/uploads/2014-07-31/3.png" class="center" width="510" height="472"> 
<p>图7-3</p>
<p>Core Data不局限于基于文档的应用程序，也能创建基于Core Data的无用户界面的Utility应用。当然其他应用程序也能使用Core Data的。</p>
<p>####7.1.1.1. 托管对象和上下文(Managed Objects and Contexts)</p>
<p>可以把托管对象上下文作为一个智能便笺。当从持久化存储中获取对象时，这些对象的临时副本会在便笺上形成一个对象图（或者对象图的集合。对象图即对象 + 对象之间的联系），然后便可以任意修改这些对象。除非保存这些修改，否则持久化存储是不会受影响的。</p>
<p>Core Data框架中的模型对象（Model Objects，它是一种含有应用程序数据的对象类型，提供对数据的访问并实现逻辑来处理数据）称为托管对象。所有托管对象都必须通过托管对象上下文进行注册。该上下文对象允许在图中加入或删除对象，以及跟踪图中对象的变化，并因此可以提供撤销（undo）和重做（redo）的支持。当准备好保存对托管对象所做的修改时，托管对象上下文负责确保那些对象处于正确的状态。</p>
<p>如果要保存所做的更改，上下文首先要验证对象是有效的。如果对象有效，所作的更改会被写到持久化存储中，创建对象会添加新记录，删除对象则会删除记录。</p>
<p>可以在应用程序中使用多个上下文。对于持久化存储中的每一个对象，只有唯一的一个托管对象和给定的上下文相关联。从不同的角度考虑，持久化存储中的一个给定的对象，可在多个上下文中同时被编辑。然而，每个上下文都有它自己的对应着源对象的托管对象，每个托管对象都单独编辑。这样保存时就会导致数据不一致。Core Data提供了一些方法来处理这个问题，比如使用- (void)refreshObject:(NSManagedObject *)object mergeChanges: (BOOL)flag方法从持久化存储中获取最新的值来更新托管对象的持久化属性。</p>
<p>####7.1.1.2.获取数据请求（Fetch Requests）</p>
<p>使用托管对象上下文来检索数据时，会创建一个获取请求（fetch request，类NSFetchRequest的实例）的所有员工，按照工资最高到最低排序”。获取请求由三部分组成。最简单的获取请求必须指定一个实体的名称（这就暗示每次只能取一种实体类型）。获取请求也可能包含一个谓词对象，指定对象必须符合的条件（比如“市场部的所有员工”）。获取请求还包含一个排序描述方式对象的数组，指定对象应该出现的顺序（比如“按照工资最高到最低排序”），如图7-4所示。</p>
<img src="/uploads/2014-07-31/4.png" class="center" width="487" height="285"> 
<p>图 7-4</p>
<p>发送获取请求给托管对象上下文，它从与持久化存储相关联的数据源中返回的匹配请求的对象（也可能没有返回）。由于所有托管对象必须在托管对象上下文中注册，从获取请求返回的对象自动注册在用来获取的上下文中。上面说到，对于持久化存储中的每一个对象，只有唯一的一个托管对象和给定的上下文相关联。如果上下文中已经包含了一个托管对象作为获取请求返回的对象，那么这个托管对象则作为获取请求结果返回。</p>
<p>Core Data框架试图尽可能的高效。Core Data是需求驱动的，因此它只会创建实际需要的对象，不会额外创建更多对象。对象图并不代表持久化存储中的所有对象。仅指定一个持久化存储并不会把任何数据对象注册到托管对象上下文中。当从持久化存储中获取对象的一个​​子集，只能得到请求的对象。如果不再需要一个对象，默认情况下它会被释放。（这当然与从对象图中删除对象不一样。）</p>
<p>####7.1.1.3.持久化存储协调器</p>
<p>如上所述，在应用程序和外部数据存储的对象之间提供访问通道的框架对象集合统称为持久化堆栈（persistence stack）。在堆栈顶部的是托管对象上下文下，在堆栈底部的是持久化对象存储（persistent object stores）。在托管对象上下文和持久化对象存储之间便是持久化存储协调器（persistent store coordinator）。应用程序通过类NSPersistentStoreCoordinator的实例访问持久化对象存储。</p>
<p>持久化存储协调器为一或多个托管对象上下文提供一个访问接口，使其下层的多个持久化存储可以表现为单一一个聚合存储。一个托管对象上下文可以基于持久化存储协调器下的所有数据存储来创建一个对象图。持久化存储协调器只能与一个托管对象模型相关联。如果想把不同的实体放到不同存储中，必须依据托管对象模型中定义的配置把模型实体分区（partition）。</p>
<p>图7-5显示了一个例子，把员工和部门存储在一个文件中，并把客户和公司存储在另一个文件中。当获取对象时，他们会自动从相应的文件中返回；当保存更改时，会自动归档到相应的文件。</p>
<img src="/uploads/2014-07-31/5.png" class="center" width="370" height="396"> 
<p>图 7-5</p>
<p>####7.1.1.4.持久化存储（Persistent Stores）</p>
<p>一个特定的持久化对象存储是与单个文件或其他外部数​​据存储相关联的，负责存储中的数据和托管对象上下文中的对象之间的映射。通常情况下，读者与持久化对象存储之间只有一个交互，就是在应用程序中为一个新的外部数据存储指定位置（例如，当用户打开或保存文档）。Core Data的大多数交互则通过托管对象上下文实现。</p>
<p>应用程序代码中——特别是应用程序中托管对象的相关逻辑——不应该为持久化存储中的数据存储作出任何假设（即由Core Data自行处理）。Core Data为几种文件格式提供原生支持，选择使用哪一个取决于应用程序的需求。应用程序体系架构保持不变，也应该能在应用程序的某个阶段，选择一个不同的文件格式。此外，如果应用程序经过适当的抽象，那么不增加任何操作，就能够利用框架的后续增强功能。例如——即使在刚开始时，只能从本地文件系统获取数据——如果一个应用程序没有假设从哪里获取数据，同时后面的某个阶段又想为一种新的远程持久化存储类型添加支持，它也应该能够使用这种新类型而不用修改代码。</p>
<p>知识点</p>
<p>尽管Core Data虽然支持的SQLite作为其持久化存储类型之一，Core Data也无法管理任意的SQLite数据库。要使用SQLite数据库，Core Data必须自行创建和管理数据库。</p>
<p>####7.1.1.5.持久化文件（Persistent Documents）</p>
<p>可以通过程序创建和配置持久化堆栈。然而，在许多情况下，只是想创建一个基于文档的应用程序来读写文件。使用类NSDocument的子类NSPersistentDocument，便可轻松的利用Core Data完成此事。默认情况下，NSPersistentDocument实例便已经创建了自己的即用型持久化堆栈，包括一个托管对象上下文，和单个持久化对象存储。在这种情况下，有文档和外部数据存储之间便建立起一个“一对一”映射。</p>
<p>NSPersistentDocument类提供了方法来访问文档的托管对象上下文，并提供NSDocument方法的标准实现来读写文件，这些操作都是在Core Data框架内进行的。默认情况下，不必编写任何额外的代码来处理对象的持久化。一个持久化文档的撤消（undo）功能也被集成在托管对象上下文。</p>
<p>###7.1.2.托管对象（Managed Objects）和托管对象模型（Managed Object Model）</p>
<p>为了既管理的对象图，也支持对象持久化，Core Data需要对它操作的对象进行详尽的描述。托管对象模型（managed object model）是一个结构（schema），用来描述应用程序中的托管对象，或实体，如图7-6所示。通常使用Xcode的数据模型设计工具来创建托管对象模型。（也可以在运行时使用代码来建模。）它是类NSManagedObjectModel的一个实例。</p>
<img src="/uploads/2014-07-31/6.png" class="center" width="368" height="136"> 
<p>图 7-6</p>
<p>该模型由一个实体描述对象（类NSEntityDescription实例）的集合组成，每个对象提供一个实体的元数据（metadata），包括实体名，实体在应用程序中的类名（类名不必要与实体名称一样），实体的属性和实体之间关系。实体的属性和关系依次由属性和关系描述对象表示出来，如图7-7所示。</p>
<img src="/uploads/2014-07-31/7.png" class="center" width="442" height="352">  
<p>图 7-7</p>
<p>托管对象必须是NSManagedObject或者NSManagedObject子类的任一实例。NSManagedObject能够表述任何实体。它使用一个私有的内部存储，以维护其属性，并实现托管对象所需的所有基本行为。托管对象有一个指向实体描述的引用。实体描述表述了实体的元数据，包括实体的名称，实体的属性和实体之间的关系。可以创建NSManagedObject子类来实现实体的其他行为。</p>
<p>###7.1.3.基本实现</p>
<ol>
<li>指定存储数据文件</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSArray</span> *paths = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>);</div><div class="line"><span class="built_in">NSString</span> *documentsDirectory = [paths lastObject];</div><div class="line"><span class="built_in">NSString</span> *persistentStorePath = [[documentsDirectory stringByAppendingPathComponent:<span class="string">@"TopSongs.sqlite"</span>] <span class="keyword">retain</span>];</div></pre></td></tr></table></figure>
<ol>
<li>创建托管对象模型</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSManagedObjectModel</span>  *managedObjectModel = [[<span class="built_in">NSManagedObjectModel</span> mergedModelFromBundles:<span class="literal">nil</span>] <span class="keyword">retain</span>];</div></pre></td></tr></table></figure>
<ol>
<li>创建持久化存储协调器，并使用SQLite数据库做持久化存储</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSURL</span> *storeUrl = [<span class="built_in">NSURL</span> fileURLWithPath:<span class="keyword">self</span>.persistentStorePath];</div><div class="line"><span class="built_in">NSPersistentStoreCoordinator</span> *persistentStoreCoordinator = [[<span class="built_in">NSPersistentStoreCoordinator</span> alloc] initWithManagedObjectModel:<span class="keyword">self</span>.managedObjectModel];</div><div class="line"><span class="built_in">NSError</span> *error = <span class="literal">nil</span>;</div><div class="line"><span class="built_in">NSPersistentStore</span> *persistentStore = [persistentStoreCoordinator addPersistentStoreWithType:<span class="built_in">NSSQLiteStoreType</span> configuration:<span class="literal">nil</span> URL:storeUrl options:<span class="literal">nil</span> error:&amp;amp;error];</div></pre></td></tr></table></figure>
<ol>
<li>创建托管对象上下文</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">NSManagedObjectContext</span> *managedObjectContext = [[<span class="built_in">NSManagedObjectContext</span> alloc] init];</div><div class="line">[managedObjectContext setPersistentStoreCoordinator: <span class="keyword">self</span>.persistentStoreCoordinator];</div></pre></td></tr></table></figure>
<ol>
<li>创建实体描述对象</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSEntityDescription</span> *entityDescription = [[<span class="built_in">NSEntityDescription</span> entityForName:<span class="string">@"Song"</span> inManagedObjectContext: <span class="keyword">self</span>.managedObjectContext] <span class="keyword">retain</span>];</div></pre></td></tr></table></figure>
<ol>
<li>创建托管对象</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSManagedObject</span> *managedObject = [[<span class="built_in">NSManagedObject</span> alloc] initWithEntity:<span class="keyword">self</span>.entityDescription insertIntoManagedObjectContext:<span class="keyword">self</span>.managedObjectContext];</div></pre></td></tr></table></figure>
<ol>
<li>保存</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">NSError</span> *saveError = <span class="literal">nil</span>;</div><div class="line">[<span class="keyword">self</span>.managedObjectContext save:&amp;amp;saveError]</div></pre></td></tr></table></figure>
<ol>
<li>创建获取数据请求</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">NSFetchRequest</span> *fetchRequest = [[<span class="built_in">NSFetchRequest</span> alloc] init];</div><div class="line"><span class="comment">// 数据排序，Sort key为NSManagedObject托管对象的一个属性</span></div><div class="line"><span class="built_in">NSSortDescriptor</span> *sortDescriptor = [[<span class="built_in">NSSortDescriptor</span> alloc] initWithKey:<span class="string">@""</span> ascending:<span class="literal">YES</span>];</div><div class="line"><span class="built_in">NSArray</span> *sortDescriptors = [[<span class="built_in">NSArray</span> alloc] initWithObjects:sortDescriptor, <span class="literal">nil</span>];</div><div class="line">[fetchRequest setSortDescriptors:sortDescriptors];</div></pre></td></tr></table></figure>
<ol>
<li>获取持久化存储中的数据，并对数据进行缓存</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">NSFetchedResultsController</span> *fetchedResultsController = [[<span class="built_in">NSFetchedResultsController</span> alloc]</div><div class="line">        initWithFetchRequest:<span class="keyword">self</span>.fetchRequest</div><div class="line">        managedObjectContext:<span class="keyword">self</span>.managedObjectContext</div><div class="line">        sectionNameKeyPath:<span class="literal">nil</span></div><div class="line">        cacheName:<span class="string">@""</span>];</div><div class="line"> </div><div class="line"><span class="built_in">NSError</span> *error;</div><div class="line"><span class="built_in">BOOL</span> success = [<span class="keyword">self</span>.fetchedResultsController performFetch:&amp;amp;error];</div></pre></td></tr></table></figure>
<ol>
<li>将数据显示在UITableView中</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSInteger</span>)numberOfSectionsInTableView:(<span class="built_in">UITableView</span> *)tableView &#123;</div><div class="line">    <span class="keyword">return</span> [[<span class="keyword">self</span>.fetchedResultsController sections] count];</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)table numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section &#123;</div><div class="line">    <span class="keyword">id</span>  sectionInfo = [[<span class="keyword">self</span>.fetchedResultsController sections] objectAtIndex:section];</div><div class="line">    <span class="keyword">return</span> [sectionInfo numberOfObjects];</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    <span class="built_in">UITableViewCell</span> *cell = ;</div><div class="line">    <span class="built_in">NSManagedObject</span> *managedObject = [<span class="keyword">self</span>.fetchedResultsController objectAtIndexPath:indexPath];</div><div class="line">    <span class="comment">// Configure the cell with data from the managed object.</span></div><div class="line">    <span class="keyword">return</span> cell;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">- (<span class="built_in">NSString</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView titleForHeaderInSection:(<span class="built_in">NSInteger</span>)section &#123;</div><div class="line">    <span class="keyword">id</span>  sectionInfo = [[<span class="keyword">self</span>.fetchedResultsController sections] objectAtIndex:section];</div><div class="line">    <span class="keyword">return</span> [sectionInfo name];</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">NSArray</span> *)sectionIndexTitlesForTableView:(<span class="built_in">UITableView</span> *)tableView &#123;</div><div class="line">    <span class="keyword">return</span> [<span class="keyword">self</span>.fetchedResultsController sectionIndexTitles];</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView sectionForSectionIndexTitle:(<span class="built_in">NSString</span> *)title atIndex:(<span class="built_in">NSInteger</span>)index &#123;</div><div class="line">    <span class="keyword">return</span> [<span class="keyword">self</span>.fetchedResultsController sectionForSectionIndexTitle:title atIndex:index];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>转自:<a href="http://hxsdit.com/1622" target="_blank" rel="external">http://hxsdit.com/1622</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.njiang.cn/2014/07/22/core-foundationyu-foundationde-qu-bie/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="姜楠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天空の城">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="天空の城" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/07/22/core-foundationyu-foundationde-qu-bie/" itemprop="url">
                  Core Foundation与Foundation的区别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-07-22T20:03:39+08:00">
              2014-07-22
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2016-12-26T16:40:34+08:00">
              2016-12-26
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/07/22/core-foundationyu-foundationde-qu-bie/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/07/22/core-foundationyu-foundationde-qu-bie/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Core Foundation框架 (CoreFoundation.framework) 是一组C语言接口，它们为iOS应用程序提供基本数据管理和服务功能。下面列举该框架支持进行管理的数据以及可提供的服务：</p>
<ul>
<li>群体数据类型 (数组、集合等)</li>
<li>程序包</li>
<li>字符串管理</li>
<li>日期和时间管理</li>
<li>原始数据块管理</li>
<li>偏好管理</li>
<li>URL及数据流操作</li>
<li>线程和RunLoop</li>
<li>端口和soket通讯</li>
</ul>
<p>Core Foundation框架和Foundation框架紧密相关，它们为相同功能提供接口，但Foundation框架提供Objective-C接口。如果您将Foundation对象和Core Foundation类型掺杂使用，则可利用两个框架之间的 “toll-free bridging”。所谓的Toll-free bridging是说您可以在某个框架的方法或函数同时使用Core Foundatio和Foundation框架中的某些类型。很多数据类型支持这一特性，其中包括群体和字符串数据类型。每个框架的类和类型描述都会对某个对象是否为 toll-free bridged，应和什么对象桥接进行说明。</p>
<p>###Objective-C指针与CoreFoundation指针之间的转换</p>
<p>ARC仅管理Objective-C指针（retain、release、autorelease），不管理CoreFoundation指针，CF指针由人工管理，手动的CFRetain和CFRelease来管理，注，CF中没有autorelease。</p>
<p>CocoaFoundation指针与CoreFoundation指针转换，需要考虑的是所指向对象所有权的归属。ARC提供了3个修饰符来管理。</p>
<ol>
<li><p>__bridge，什么也不做，仅仅是转换。此种情况下：</p>
<p> i). 从Cocoa转换到Core，需要人工CFRetain，否则，Cocoa指针释放后， 传出去的指针则无效。</p>
<p> ii). 从Core转换到Cocoa，需要人工CFRelease，否则，Cocoa指针释放后，对象引用计数仍为1，不会被销毁。</p>
</li>
<li><p>__bridge_retained，转换后自动调用<code>CFRetain</code>，即帮助自动解决上述i的情形。</p>
</li>
<li><p>__bridge_transfer，转换后自动调用<code>CFRelease</code>，即帮助自动解决上述ii的情形。</p>
</li>
</ol>
<p>由于ARC不能管理Core Foundation Object的生命周期，所以在Core Foundation和ARC之间，我们需要使用到<code>__bridge</code>,<code>__bridge_retained</code>和<code>__bridge_transfer</code>三个转换关键字。</p>
<p>根据苹果官方的文档</p>
<p><a href="https://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html" target="_blank" rel="external">https://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html</a></p>
<p><code>__bridge</code>只做类型转换，但是不修改对象（内存）管理权；</p>
<p><code>__bridge_retained</code>（也可以使用<code>CFBridgingRetain</code>）将Objective-C的对象转换为Core Foundation的对象，同时将对象（内存）的管理权交给我们，后续需要使用CFRelease或者相关方法来释放对象；</p>
<p><code>__bridge_transfer</code>（也可以使用CFBridgingRelease）将Core Foundation的对象转换为Objective-C的对象，同时将对象（内存）的管理权交给ARC。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar/avatar.jpg"
               alt="姜楠" />
          <p class="site-author-name" itemprop="name">姜楠</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">115</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">25</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/njiang1987" target="_blank" title="github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  github
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">姜楠</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"njiang"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  

  


</body>
</html>
